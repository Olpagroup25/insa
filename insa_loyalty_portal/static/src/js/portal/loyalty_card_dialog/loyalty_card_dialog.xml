<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <!--
        Patch the loyalty card dialog: translate to Spanish + add CSS hooks.
        t-inherit-mode="extension" patches the ORIGINAL template in-place.
    -->
    <t t-name="insa_loyalty_portal.loyalty_dialog_patch"
       t-inherit="loyalty.portal_loyalty_card_dialog"
       t-inherit-mode="extension">

        <!-- Add a CSS class to the Dialog for styling -->
        <xpath expr="//Dialog" position="attributes">
            <attribute name="contentClass">'insa-loyalty-dialog'</attribute>
        </xpath>

        <!-- Translate "Last Transactions" -->
        <xpath expr="//strong[.='Last Transactions']" position="replace">
            <strong>Últimas Transacciones</strong>
        </xpath>

        <!-- Translate "-> View History" link -->
        <xpath expr="//a[contains(., 'View History')]" position="replace">
            <a t-attf-href="/my/loyalty_card/{{props.card.id}}/history/" class="insa-loyalty-view-history-link">
                → Ver Historial Completo
            </a>
        </xpath>

        <!-- Translate empty state alert -->
        <xpath expr="//p[hasclass('alert-warning')]" position="replace">
            <p class="insa-loyalty-empty-state">
                Aún no tenés transacciones registradas.
            </p>
        </xpath>

        <!-- Translate expiration text "Valid until" -->
        <xpath expr="//i[hasclass('text-secondary')]" position="replace">
            <i class="text-secondary fs-6" t-if="props.card.expiration_date">
                Válido hasta <t t-out="props.card.expiration_date"/>
            </i>
        </xpath>

    </t>
</templates>
